<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="tb_knowledge_column">
	<typeAlias alias="knowledgeColumn" type="com.ginkgocap.ywxt.knowledge.model.KnowledgeColumn"/>
	<resultMap class="com.ginkgocap.ywxt.knowledge.model.KnowledgeColumn" id="knowledgeColumnMap">
		<result column="id" property="id" jdbcType="BIGINT"/>
		<result column="column_name" property="columnName" jdbcType="VARCHAR"/>
		<result column="parent_column_id" property="parentColumnId" jdbcType="INT"/>
		<result column="create_user_id" property="createUserId" jdbcType="INT"/>
		<result column="tag" property="tag" jdbcType="VARCHAR"/>
		<result column="level" property="level" jdbcType="INT"/>
		<result column="column_level_path" property="columnLevelPath" jdbcType="VARCHAR"/>
		<result column="create_time" property="createTime" jdbcType="java.util.Date"/>
		<result column="update_time" property="updateTime" jdbcType="java.util.Date"/>
	</resultMap>
	
	
	<sql id="allColumns">
	  id,
	  column_name,
	  parent_column_id,
	  create_user_id,
	  tag,
	  level,
	  column_level_path,
	  create_time,
	  update_time
	</sql>
	
	<update id="update" parameterClass="knowledgeColumn">  
        UPDATE tb_knowledge_column SET  
			column_name=#columnName:VARCHAR#,
			parent_column_id=#parentColumnId:INT#,
			create_user_id=#createUserId:INT#,
			tag=#tag:VARCHAR#,
			level=#level:INT#,
			column_level_path=#columnLevelPath:VARCHAR#
			create_time=#createTime:java.util.Date#,
			update_time=#updateTime:java.util.Date#
        WHERE   
        	id=#id:BIGINT#   
    </update>
	
	<insert id="insert" parameterClass="knowledgeColumn">
		insert into tb_knowledge_column(
			  column_name,
			  parent_column_id,
			  create_user_id,
			  tag,
			  level,
			  column_level_path,
			  create_time,
			  update_time
		) values (
			column_name=#columnName:VARCHAR#,
			parent_column_id=#parentColumnId:INT#,
			create_user_id=#createUserId:INT#,
			tag=#tag:VARCHAR#,
			level=#level:INT#,
			column_level_path=#columnLevelPath:VARCHAR#
			create_time=#createTime:java.util.Date#,
			update_time=#updateTime:java.util.Date#
		)
		<selectKey resultClass="long" type="post" keyProperty="id" > 
		SELECT LAST_INSERT_ID() AS VALUE     
		</selectKey>
	</insert>
	
    <select id="selectById" resultMap="knowledgeColumnMap" parameterClass="long">
		select <include refid="allColumns"/>
		from tb_knowledge_column where id=#id#
	</select>
	
	<select id="selectByParentId" resultMap="knowledgeColumnMap" parameterClass="java.util.Map">
		select <include refid="allColumns"/>
		from tb_knowledge_column where parent_column_id=#parentColumnId# and create_user_id=#createUserId#
	</select>
	 
</sqlMap>