<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ginkgocap.ywxt.knowledge.mapper.ColumnVOValueMapper">
	<resultMap id="BaseResultMap" type="com.ginkgocap.ywxt.knowledge.model.ColumnVO">
		<id column="id" property="id" jdbcType="BIGINT" />
		<result column="columnName" property="columnname" jdbcType="VARCHAR" />
		<result column="user_id" property="userId" jdbcType="BIGINT" />
		<result column="parent_id" property="parentId" jdbcType="BIGINT" />
		<result column="createtime" property="createtime" jdbcType="TIMESTAMP" />
		<result column="column_level_path" property="columnLevelPath"
			jdbcType="VARCHAR" />
		<result column="del_status" property="delStatus" jdbcType="TINYINT" />
		<result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
		<result column="subscribe_count" property="subscribeCount"
			jdbcType="BIGINT" />
		<result column="type" property="type" jdbcType="SMALLINT" />
		<result column="ishas" property="ishas" />
	</resultMap>
	<select id="selectColumnByPid" resultMap="BaseResultMap" >
		SELECT 
		a.id,
		a.columnName,
		a.parent_id,
		a.user_id,
		a.column_level_path,
		a.path_name,
		a.createtime,
		a.update_time,
		a.del_status,
		a.subscribe_count,
		a.type,
		b.ishas 
		FROM tb_column a 
		LEFT JOIN (SELECT DISTINCT parent_id , 1  'ishas' FROM tb_column where del_status=0
		and (user_id=#{userId} or user_id=0)) b 
		ON a.id = b.parent_id
		where a.del_status=0
		and (a.user_id=#{userId} or a.user_id=0)
		and a.parent_id=#{pid}
	</select>
	
</mapper>